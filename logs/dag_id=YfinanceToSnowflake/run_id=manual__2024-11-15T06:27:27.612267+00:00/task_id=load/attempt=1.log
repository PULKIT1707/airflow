[2024-11-15T06:27:53.019+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-11-15T06:27:53.611+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: YfinanceToSnowflake.load manual__2024-11-15T06:27:27.612267+00:00 [queued]>
[2024-11-15T06:27:53.650+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: YfinanceToSnowflake.load manual__2024-11-15T06:27:27.612267+00:00 [queued]>
[2024-11-15T06:27:53.651+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-11-15T06:27:53.826+0000] {taskinstance.py:2330} INFO - Executing <Task(_PythonDecoratedOperator): load> on 2024-11-15 06:27:27.612267+00:00
[2024-11-15T06:27:53.901+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:61 DeprecationWarning: This process (pid=22403) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-11-15T06:27:53.910+0000] {standard_task_runner.py:63} INFO - Started process 22417 to run task
[2024-11-15T06:27:53.925+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'YfinanceToSnowflake', 'load', 'manual__2024-11-15T06:27:27.612267+00:00', '--job-id', '399', '--raw', '--subdir', 'DAGS_FOLDER/yfinance_to_snowflake.py', '--cfg-path', '/tmp/tmpji54pi55']
[2024-11-15T06:27:53.939+0000] {standard_task_runner.py:91} INFO - Job 399: Subtask load
[2024-11-15T06:27:54.771+0000] {task_command.py:426} INFO - Running <TaskInstance: YfinanceToSnowflake.load manual__2024-11-15T06:27:27.612267+00:00 [running]> on host 5bbe89177473
[2024-11-15T06:27:58.111+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='YfinanceToSnowflake' AIRFLOW_CTX_TASK_ID='load' AIRFLOW_CTX_EXECUTION_DATE='2024-11-15T06:27:27.612267+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-11-15T06:27:27.612267+00:00'
[2024-11-15T06:27:58.122+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-11-15T06:27:58.322+0000] {base.py:84} INFO - Using connection ID 'snowflake_conn' for task execution.
[2024-11-15T06:27:58.330+0000] {connection.py:399} INFO - Snowflake Connector for Python Version: 3.10.0, Python Version: 3.12.3, Platform: Linux-6.10.11-linuxkit-x86_64-with-glibc2.36
[2024-11-15T06:27:58.334+0000] {connection.py:1239} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-11-15T06:28:02.171+0000] {logging_mixin.py:188} INFO - inside load:                         date        open  ...  Stock Splits  symbol
0  2024-08-19 00:00:00-04:00  225.471943  ...           0.0    AAPL
1  2024-08-20 00:00:00-04:00  225.521886  ...           0.0    AAPL
2  2024-08-21 00:00:00-04:00  226.271063  ...           0.0    AAPL
3  2024-08-22 00:00:00-04:00  227.539661  ...           0.0    AAPL
4  2024-08-23 00:00:00-04:00  225.412002  ...           0.0    AAPL
..                       ...         ...  ...           ...     ...
58 2024-11-08 00:00:00-05:00  227.169998  ...           0.0    AAPL
59 2024-11-11 00:00:00-05:00  225.000000  ...           0.0    AAPL
60 2024-11-12 00:00:00-05:00  224.550003  ...           0.0    AAPL
61 2024-11-13 00:00:00-05:00  224.009995  ...           0.0    AAPL
62 2024-11-14 00:00:00-05:00  225.020004  ...           0.0    AAPL

[63 rows x 9 columns]
[2024-11-15T06:28:02.347+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-11-15T06:28:02.618+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-11-15T06:28:02.628+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-19' AS date,
                       225.47 AS open,
                       225.74 AS high,
                       222.79 AS low,
                       225.64 AS close,
                       40687800 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:03.249+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-20' AS date,
                       225.52 AS open,
                       226.92 AS high,
                       225.2 AS low,
                       226.26 AS close,
                       30299000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:03.760+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-21' AS date,
                       226.27 AS open,
                       227.73 AS high,
                       224.8 AS low,
                       226.15 AS close,
                       34765500 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:05.068+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-22' AS date,
                       227.54 AS open,
                       228.09 AS high,
                       223.65 AS low,
                       224.28 AS close,
                       43695300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:05.746+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-23' AS date,
                       225.41 AS open,
                       227.97 AS high,
                       224.08 AS low,
                       226.59 AS close,
                       38677300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:06.306+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-26' AS date,
                       226.51 AS open,
                       227.03 AS high,
                       223.64 AS low,
                       226.93 AS close,
                       30602200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:07.204+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-27' AS date,
                       225.75 AS open,
                       228.6 AS high,
                       224.64 AS low,
                       227.78 AS close,
                       35934600 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:08.005+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-28' AS date,
                       227.67 AS open,
                       229.61 AS high,
                       225.43 AS low,
                       226.24 AS close,
                       38052200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:08.829+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-29' AS date,
                       229.85 AS open,
                       232.66 AS high,
                       228.63 AS low,
                       229.54 AS close,
                       51906300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:09.657+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-08-30' AS date,
                       229.94 AS open,
                       230.15 AS high,
                       227.23 AS low,
                       228.75 AS close,
                       52990800 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:10.284+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-03' AS date,
                       228.3 AS open,
                       228.75 AS high,
                       220.93 AS low,
                       222.53 AS close,
                       50190600 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:11.024+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-04' AS date,
                       221.42 AS open,
                       221.54 AS high,
                       217.24 AS low,
                       220.61 AS close,
                       43840200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:11.770+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-05' AS date,
                       221.39 AS open,
                       225.23 AS high,
                       221.28 AS low,
                       222.14 AS close,
                       36615400 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:12.391+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-06' AS date,
                       223.7 AS open,
                       224.99 AS high,
                       219.53 AS low,
                       220.58 AS close,
                       48423000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:13.111+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-09' AS date,
                       220.58 AS open,
                       221.03 AS high,
                       216.47 AS low,
                       220.67 AS close,
                       67180000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:13.691+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-10' AS date,
                       218.68 AS open,
                       221.24 AS high,
                       216.49 AS low,
                       219.87 AS close,
                       51591000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:14.320+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-11' AS date,
                       221.22 AS open,
                       222.84 AS high,
                       217.65 AS low,
                       222.42 AS close,
                       44587100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:14.904+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-12' AS date,
                       222.26 AS open,
                       223.3 AS high,
                       219.58 AS low,
                       222.53 AS close,
                       37498200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:15.653+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-13' AS date,
                       223.33 AS open,
                       223.79 AS high,
                       221.67 AS low,
                       222.26 AS close,
                       36766600 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:16.817+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-16' AS date,
                       216.3 AS open,
                       216.98 AS high,
                       213.68 AS low,
                       216.08 AS close,
                       59357400 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:17.706+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-17' AS date,
                       215.51 AS open,
                       216.66 AS high,
                       214.26 AS low,
                       216.55 AS close,
                       45519300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:18.311+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-18' AS date,
                       217.31 AS open,
                       222.47 AS high,
                       217.3 AS low,
                       220.45 AS close,
                       59894900 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:19.108+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-19' AS date,
                       224.74 AS open,
                       229.57 AS high,
                       224.38 AS low,
                       228.62 AS close,
                       66781300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:19.968+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-20' AS date,
                       229.72 AS open,
                       232.83 AS high,
                       227.37 AS low,
                       227.95 AS close,
                       318679900 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:20.641+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-23' AS date,
                       227.09 AS open,
                       229.2 AS high,
                       225.56 AS low,
                       226.22 AS close,
                       54146000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:21.467+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-24' AS date,
                       228.4 AS open,
                       229.1 AS high,
                       225.48 AS low,
                       227.12 AS close,
                       43556100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:22.092+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-25' AS date,
                       224.68 AS open,
                       227.04 AS high,
                       223.77 AS low,
                       226.12 AS close,
                       42308700 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:22.991+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-26' AS date,
                       227.05 AS open,
                       228.25 AS high,
                       225.16 AS low,
                       227.27 AS close,
                       36636700 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:23.906+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-27' AS date,
                       228.21 AS open,
                       229.27 AS high,
                       227.05 AS low,
                       227.54 AS close,
                       34026000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:24.549+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-09-30' AS date,
                       229.79 AS open,
                       232.74 AS high,
                       229.4 AS low,
                       232.74 AS close,
                       54541900 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:25.268+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-01' AS date,
                       229.27 AS open,
                       229.4 AS high,
                       223.49 AS low,
                       225.96 AS close,
                       63285000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:26.013+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-02' AS date,
                       225.64 AS open,
                       227.12 AS high,
                       222.77 AS low,
                       226.53 AS close,
                       32880600 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:26.905+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-03' AS date,
                       224.89 AS open,
                       226.56 AS high,
                       223.07 AS low,
                       225.42 AS close,
                       34044200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:27.630+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-04' AS date,
                       227.65 AS open,
                       227.75 AS high,
                       223.88 AS low,
                       226.55 AS close,
                       37245100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:28.685+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-07' AS date,
                       224.25 AS open,
                       225.44 AS high,
                       221.09 AS low,
                       221.45 AS close,
                       39505400 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:29.495+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-08' AS date,
                       224.05 AS open,
                       225.73 AS high,
                       223.0 AS low,
                       225.52 AS close,
                       31855700 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:30.312+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-09' AS date,
                       224.98 AS open,
                       229.5 AS high,
                       224.58 AS low,
                       229.29 AS close,
                       33591100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:31.044+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-10' AS date,
                       227.53 AS open,
                       229.25 AS high,
                       226.92 AS low,
                       228.79 AS close,
                       28183500 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:32.152+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-11' AS date,
                       229.05 AS open,
                       229.16 AS high,
                       227.09 AS low,
                       227.3 AS close,
                       31759200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:33.164+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-14' AS date,
                       228.45 AS open,
                       231.48 AS high,
                       228.35 AS low,
                       231.05 AS close,
                       39882100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:34.058+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-15' AS date,
                       233.35 AS open,
                       237.23 AS high,
                       232.11 AS low,
                       233.59 AS close,
                       64751400 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:34.811+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-16' AS date,
                       231.35 AS open,
                       231.86 AS high,
                       229.59 AS low,
                       231.53 AS close,
                       34082200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:35.603+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-17' AS date,
                       233.17 AS open,
                       233.59 AS high,
                       230.27 AS low,
                       231.89 AS close,
                       32993800 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:36.475+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-18' AS date,
                       235.92 AS open,
                       235.92 AS high,
                       233.75 AS low,
                       234.74 AS close,
                       46431500 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:37.410+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-21' AS date,
                       234.19 AS open,
                       236.59 AS high,
                       234.19 AS low,
                       236.22 AS close,
                       36254500 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:38.382+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-22' AS date,
                       233.63 AS open,
                       235.96 AS high,
                       232.34 AS low,
                       235.6 AS close,
                       38846600 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:39.489+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-23' AS date,
                       233.82 AS open,
                       234.88 AS high,
                       227.51 AS low,
                       230.51 AS close,
                       52287000 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:41.351+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-24' AS date,
                       229.73 AS open,
                       230.57 AS high,
                       228.16 AS low,
                       230.32 AS close,
                       31109500 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:43.153+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-25' AS date,
                       229.49 AS open,
                       232.96 AS high,
                       229.32 AS low,
                       231.16 AS close,
                       38802300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:44.271+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-28' AS date,
                       233.06 AS open,
                       234.47 AS high,
                       232.29 AS low,
                       233.14 AS close,
                       36087100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:45.412+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-29' AS date,
                       232.84 AS open,
                       234.07 AS high,
                       232.06 AS low,
                       233.41 AS close,
                       35417200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:46.793+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-30' AS date,
                       232.35 AS open,
                       233.21 AS high,
                       229.3 AS low,
                       229.85 AS close,
                       47070900 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:47.679+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-10-31' AS date,
                       229.09 AS open,
                       229.58 AS high,
                       225.12 AS low,
                       225.66 AS close,
                       64370100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:48.357+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-01' AS date,
                       220.73 AS open,
                       225.1 AS high,
                       220.03 AS low,
                       222.67 AS close,
                       65276700 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:49.091+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-04' AS date,
                       220.75 AS open,
                       222.55 AS high,
                       219.47 AS low,
                       221.77 AS close,
                       44944500 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:49.936+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-05' AS date,
                       221.56 AS open,
                       223.7 AS high,
                       220.9 AS low,
                       223.2 AS close,
                       28111300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:50.820+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-06' AS date,
                       222.37 AS open,
                       225.82 AS high,
                       220.95 AS low,
                       222.48 AS close,
                       54561100 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:53.227+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-07' AS date,
                       224.38 AS open,
                       227.63 AS high,
                       224.32 AS low,
                       227.23 AS close,
                       42137700 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:54.283+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-08' AS date,
                       227.17 AS open,
                       228.66 AS high,
                       226.41 AS low,
                       226.96 AS close,
                       38328800 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:55.260+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-11' AS date,
                       225.0 AS open,
                       225.7 AS high,
                       221.5 AS low,
                       224.23 AS close,
                       42005600 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:56.083+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-12' AS date,
                       224.55 AS open,
                       225.59 AS high,
                       223.36 AS low,
                       224.23 AS close,
                       40398300 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:56.911+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-13' AS date,
                       224.01 AS open,
                       226.65 AS high,
                       222.76 AS low,
                       225.12 AS close,
                       48566200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:28:57.581+0000] {logging_mixin.py:188} INFO - Executing MERGE query: 
            MERGE INTO stock_db.raw_data.stock_prices AS target
            USING (
                SELECT '2024-11-14' AS date,
                       225.02 AS open,
                       228.87 AS high,
                       225.0 AS low,
                       228.22 AS close,
                       44880200 AS volume,
                       'AAPL' AS symbol
            ) AS source
            ON target.date = source.date AND target.symbol = source.symbol
            WHEN MATCHED THEN
                UPDATE SET
                    open = source.open,
                    high = source.high,
                    low = source.low,
                    close = source.close,
                    volume = source.volume
            WHEN NOT MATCHED THEN
                INSERT (date, open, high, low, close, volume, symbol)
                VALUES (source.date, source.open, source.high, source.low, source.close, source.volume, source.symbol);
            
[2024-11-15T06:29:04.139+0000] {cursor.py:1149} INFO - Number of results in first chunk: 1
[2024-11-15T06:29:04.177+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-11-15T06:29:04.180+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-11-15T06:29:04.386+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=YfinanceToSnowflake, task_id=load, run_id=manual__2024-11-15T06:27:27.612267+00:00, execution_date=20241115T062727, start_date=20241115T062753, end_date=20241115T062904
[2024-11-15T06:29:04.845+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2024-11-15T06:29:05.452+0000] {taskinstance.py:3498} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-11-15T06:29:05.651+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
